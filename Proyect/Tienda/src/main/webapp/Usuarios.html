<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Mi Tienda | Usuarios</title>

        <!-- Google Font: Source Sans Pro -->
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
        <!-- Font Awesome -->
        <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">
        <!-- Theme style -->
        <link rel="stylesheet" href="dist/css/adminlte.min.css">
        <script src = "http://ajax.googleapis.com/ajax/libs/angularjs/1.2.15/angular.min.js"></script>

    </head>
    <body class="hold-transition sidebar-mini">
        <div class="wrapper">
            <!-- Navbar -->
            <nav class="main-header navbar navbar-expand navbar-white navbar-light">


                <!-- Right navbar links -->
                <ul class="navbar-nav ml-auto">
                    <!-- Navbar Search -->
                    <li class="nav-item">
                        <a class="nav-link" data-widget="navbar-search" href="#" role="button">

                        </a>

                    </li>

                    <!-- Messages Dropdown Menu -->

                    <!-- Notifications Dropdown Menu -->


                </ul>
            </nav>


            <!-- Main Sidebar Container -->
            <aside class="main-sidebar sidebar-dark-primary elevation-4">
                <!-- Brand Logo -->

                <!-- Sidebar -->
                <div class="sidebar">
                    <!-- Sidebar user (optional) -->
                    <div class="user-panel mt-3 pb-3 mb-3 d-flex">
                        <div class="image">
                            <img src="dist/img/user2-160x160.jpg" class="img-circle elevation-2" alt="User Image">
                        </div>
                        <div class="info">
                            <a href="#" class="d-block">Usuarios</a>
                        </div>
                    </div>

                    <!-- SidebarSearch Form -->


                    <!-- Sidebar Menu -->
                    <nav class="mt-2">
                        <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                            <!-- Add icons to the links using the .nav-icon class
                                 with font-awesome or any other icon font library -->


                            <li class="nav-item">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-th"></i>
                                    <p>
                                        Menú
                                        <i class="fas fa-angle-left right"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">
                                    <li class="nav-item">
                                        <a href="../mailbox/mailbox.html" class="nav-link">
                                            <i class="far fa-circle nav-icon"></i>
                                            <p>Vender</p>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="../mailbox/compose.html" class="nav-link">
                                            <i class="far fa-circle nav-icon"></i>
                                            <p>Inventario</p>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="../mailbox/read-mail.html" class="nav-link">
                                            <i class="far fa-circle nav-icon"></i>
                                            <p>Todas las facturas</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>

                        </ul>
                    </nav>
                    <!-- /.sidebar-menu -->
                </div>
                <!-- /.sidebar -->
            </aside>

            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                <!-- Content Header (Page header) -->
                <section class="content-header">
                    <div class="container-fluid">
                        <div class="row mb-2">
                            <div class="col-sm-6">
                                <h1>Usuarios</h1>
                            </div>
                            <div class="col-sm-6">
                                <ol class="breadcrumb float-sm-right">
                                    <li class="breadcrumb-item"><a href="#">Inicio</a></li>
                                    <li class="breadcrumb-item active">Usuarios</li>
                                </ol>
                            </div>
                        </div>
                    </div><!-- /.container-fluid -->
                </section>

                <!-- Main content -->
                <section class="content" ng-app="usuarios2" ng-controller="testController as tc">
                    <div class="container-fluid" >
                        <div class="row">
                            <!-- left column -->
                            <div class="col-md-12">
                                <!-- Registrar Usuarios -->

                                <div class="card card-primary">
                                    <div class="card-header">
                                        <h3 class="card-title">Registrar nuevo Usuario</h3>
                                    </div>
                                    <div class="card-body">
                                        <!-- Fila 1 -->
                                        <div class="row">

                                            <div class="col-2">
                                                <div class="form-group">
                                                    <label>Rol</label>
                                                    <select class="form-control" ng-model="tc.usuario.rolUsuario">
                                                        <option selected="selected" >Seleccione...</option>
                                                        <option>Administrador</option>
                                                        <option>Vendedor</option>                                                                                                                  
                                                    </select>
                                                </div>
                                            </div>

                                            <div class="col-3">
                                                <label for="exampleInputEmail1">Usuario</label>
                                                <input type="text" class="form-control" placeholder="Usuario" ng-model="tc.usuario.nombreUsuario">
                                            </div>

                                            <div class="col-3">
                                                <label for="exampleInputEmail1">Contraseña</label>
                                                <input type="text" class="form-control" placeholder="Contraseña"ng-model="tc.usuario.clave">
                                            </div>
                                        </div>  

                                        <!-- Fila 2 -->
                                        <div class="row">
                                            <div class="col-3">
                                                <label for="exampleInputEmail1">Nombres</label>
                                                <input type="text" class="form-control" placeholder="Nombres" ng-model="tc.usuario.nombres">
                                            </div>
                                            <div class="col-3">
                                                <label for="exampleInputEmail1">Apellidos</label>
                                                <input type="text" class="form-control" placeholder="Apellidos" ng-model="tc.usuario.apellidos">
                                            </div>
                                            <!-- select -->
                                            <div class="col-2">
                                                <div class="form-group">
                                                    <label>Genero</label>
                                                    <select class="form-control" ng-model="tc.usuario.genero">
                                                        <option selected="selected"  >Seleccione...</option>
                                                        <option>Masculino</option>
                                                        <option>Femenino</option>
                                                        <option>Otro</option>                                                            
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Fila 3 -->
                                        <div class="row">
                                            <!-- select -->
                                            <div class="col-2">
                                                <div class="form-group">
                                                    <label>Tipo de Documento</label>
                                                    <select class="form-control" ng-model="tc.usuario.tipoIdentificacion">
                                                        <option selected="selected" n>Seleccione...</option>
                                                        <option>CC</option>
                                                        <option>TI</option>
                                                        <option>CE</option>                                                            
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <label for="exampleInputEmail1">N° de Documento</label>
                                                <input type="text" class="form-control" placeholder="N° de Documento" ng-model="tc.usuario.numeroIdentificacion">
                                            </div>
                                            <div class="col-3">
                                                <label for="exampleInputEmail1">Fecha de nacimiento</label>
                                                <input type="text" class="form-control" placeholder="dd/mm/aaaa"  ng-model="tc.usuario.fechaNacimiento">
                                            </div>
                                        </div>

                                        <!-- Fila 4 -->
                                        <div class="row">

                                            <div class="col-3">
                                                <label for="exampleInputEmail1">Ciudad de domicilio</label>
                                                <input type="text" class="form-control" placeholder="Ciudad de domicilio"  ng-model="tc.usuario.ciudadDomicilio">
                                            </div>
                                            <div class="col-3">
                                                <label for="exampleInputEmail1">Dirección</label>
                                                <input type="text" class="form-control" placeholder="Dirección"  ng-model="tc.usuario.direccion">
                                            </div>

                                            <div class="col-2">
                                                <label for="exampleInputEmail1">Telefono</label>
                                                <input type="text" class="form-control" placeholder="Teléfono"  ng-model="tc.usuario.telefono">
                                            </div>
                                            <div class="col-3">
                                                <label for="exampleInputEmail1">Correo personal</label>
                                                <input type="email" class="form-control" placeholder="correo@mail.com"  ng-model="tc.usuario.correoPersonal">
                                            </div>
                                        </div>

                                    </div>


                                    <div class="card-footer">



                                        <button type="submit" class="btn btn-primary" ng-click="tc.limpiar()">Limpiar</button>
                                        <button type="submit" class="btn btn-primary" ng-click="tc.listar()">Ver lista</button>
                                        <button type="submit" class="btn btn-primary" ng-click="tc.guardar()">Guardar</button>
                                    </div>



                                </div>
                                <!-- /.card-body -->
                            </div>
                            <!-- /.card -->


                        </div>
                        <!--/.col (right) -->
                    </div>
                    <!-- /.row -->

                    <!-- LISTA DE USUARIOS -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Lista de Usuarios</h3>
                        </div>
                        <!-- /.card-header -->
                        <div class="card-body p-0">

                            <div style="overflow:scroll;">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>

                                            <th style="width: 10px">ID</th>
                                            <th>Nombres</th>
                                            <th>Apellidos</th>
                                            <th>Genero</th>
                                            <th>Tipo de documento</th>
                                            <th>N° de documento</th>
                                            <th>Fecha de nacimiento</th>
                                            <th>Ciudad de domicilio</th>
                                            <th>Dirección</th>
                                            <th>Telefono</th>
                                            <th>Correo Personal</th>
                                            <th>Rol</th>
                                            <th>Usuario</th>
                                            <!-- /<th>Contraseña</th> -->
                                            <th>Editar</th>
                                            <th>Eliminar</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="usuario in tc.usuarios">
                                            <td>{{usuario.idUsuarios}}</td>
                                            <td>{{usuario.nombres}}</td>
                                            <td>{{usuario.apellidos}}</td>
                                            <td>{{usuario.genero}}</td>
                                            <td>{{usuario.tipoIdentificacion}}</td>
                                            <td>{{usuario.numeroIdentificacion}}</td>
                                            <td>{{usuario.fechaNacimiento}}</td>
                                            <td>{{usuario.ciudadDomicilio}}</td>
                                            <td>{{usuario.direccion}}</td>
                                            <td>{{usuario.telefono}}</td>
                                            <td>{{usuario.correoPersonal}}</td>
                                            <td>{{usuario.rolUsuario}}</td>
                                            <td>{{usuario.nombreUsuario}}</td>

                                            <td><span><a href="#" data-toggle="tooltip" data-placement="top" title="Edit" ng-click="tc.seleccionar(usuario.idUsuarios)"><i class="fas fa-edit"></i></a></span>
                                            <td><span><a href="#" data-toggle="tooltip" data-placement="top" title="Close" ng-click="tc.eliminar(usuario.idUsuarios)"><i class="fas fa-trash"></i></a></span>


                                        </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- /.card-body -->




                    </div><!-- /.container-fluid -->


                </section>
                <!-- /.content -->
            </div>
            <!-- /.content-wrapper -->
            <footer class="main-footer">
                <div class="float-right d-none d-sm-block">
                    <b>Version</b> 3.1.0
                </div>
                <strong>Copyright &copy; 2014-2021 <a href="https://adminlte.io">AdminLTE.io</a>.</strong> All rights reserved.
            </footer>

            <!-- Control Sidebar -->
            <aside class="control-sidebar control-sidebar-dark">
                <!-- Control sidebar content goes here -->
            </aside>
            <!-- /.control-sidebar -->
        </div>
        <!-- ./wrapper -->

        <!-- jQuery -->
        <script src="plugins/jquery/jquery.min.js"></script>
        <!-- Bootstrap 4 -->
        <script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
        <!-- bs-custom-file-input -->
        <script src="plugins/bs-custom-file-input/bs-custom-file-input.min.js"></script>
        <!-- AdminLTE App -->
        <script src="dist/js/adminlte.min.js"></script>
        <!-- AdminLTE for demo purposes -->
        <script src="dist/js/demo.js"></script>
        <!-- Page specific script -->
        <script>
            $(function () {
                bsCustomFileInput.init();
            });
        </script>
    </body>
    <script>
        var app = angular.module('usuarios2', []);
        app.controller('testController', ['$http', initController]);
        function initController($http) {
            var controlador = this;



            controlador.listar = function () {
                var parametros = {opcion: "listar"};

                $http({
                    method: 'POST',
                    url: 'http://localhost:8080/Prueba/controller/UsuarioController.jsp',
                    params: parametros
                }).then(function (res) {
                    //alert("hola" + res.data.idUsuarios);
                    console.log(res);
                    controlador.usuarios = res.data;
                    controlador.usuario.idUsuarios= undefined;

                });
            };

            controlador.guardar = function () {
                if (controlador.usuario.idUsuarios === undefined) {
                    var parametros = {opcion: "insertar", datos: JSON.stringify(controlador.usuario)};

                    $http({
                        method: 'POST',
                        url: 'http://localhost:8080/Prueba/controller/UsuarioController.jsp',
                        params: parametros
                    }).then(function (res) {
                        //alert("hola" + res.data.idUsuarios);
                        console.log(res);
                        controlador.respuesta = res.data;
                        controlador.listar();
                        controlador.limpiar();

                    });}
                else {
                    var parametros = {opcion: "actualizar", datos: JSON.stringify(controlador.usuario)};

                  $http({
                        method: 'POST',
                        url: 'http://localhost:8080/Prueba/controller/UsuarioController.jsp',
                        params: parametros
                 }).then(function (res) {
                        //alert("hola" + res.data.idUsuarios);
                        console.log(res);
                        controlador.respuesta = res.data;
                        controlador.listar();
                        controlador.limpiar();

                    });
               }

            };


            controlador.limpiar = function () {
                controlador.usuario.nombres = "";
                controlador.usuario.clave = "";
                controlador.usuario.apellidos = "";
                controlador.usuario.genero = "Seleccione...";
                controlador.usuario.tipoIdentificacion = "Seleccione...";
                controlador.usuario.numeroIdentificacion = "";
                controlador.usuario.fechaNacimiento = "";
                controlador.usuario.ciudadDomicilio = "";
                controlador.usuario.direccion = "";
                controlador.usuario.telefono = "";
                controlador.usuario.correoPersonal = "";
                controlador.usuario.rolUsuario = "";
                controlador.usuario.nombreUsuario = "";
            };


            controlador.seleccionar = function (id) {
                for (var i = 0; i < controlador.usuarios.length; i++) {
                    if (id === controlador.usuarios[i].idUsuarios) {
                        controlador.usuario = controlador.usuarios[i];
                    }
                }
            };


            controlador.eliminar = function (id) {
                for (var i = 0; i < controlador.usuarios.length; i++) {
                    if (id === controlador.usuarios[i].idUsuarios) {
                        controlador.usuario = controlador.usuarios[i];
                    }
                }

                var parametros = {opcion: "eliminar", datos: JSON.stringify(controlador.usuario)};

                $http({
                    method: 'POST',
                    url: 'http://localhost:8080/Prueba/controller/UsuarioController.jsp',
                    params: parametros
                }).then(function (res) {
                    //alert("hola" + res.data.idUsuarios);
                    console.log(res);
                    controlador.listar();

                });
            };


        }
    </script>


</html>
